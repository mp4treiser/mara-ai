# üöÄ MARA-AI Backend

**FastAPI Backend –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã MARA-AI**

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π backend —Å–µ—Ä–≤–∏—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π AI-–∞–≥–µ–Ω—Ç–æ–≤, –±–ª–æ–∫—á–µ–π–Ω –∫–æ—à–µ–ª—å–∫–æ–≤, Telegram –±–æ—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–ø–∏—Å–æ–∫.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

```
backend/src/
‚îú‚îÄ‚îÄ account/              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ repositories/     # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ schemas/          # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ routers/          # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îú‚îÄ‚îÄ agents/               # AI-–∞–≥–µ–Ω—Ç—ã –∏ RAG —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –∞–≥–µ–Ω—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ repositories/     # –†–∞–±–æ—Ç–∞ —Å –∞–≥–µ–Ω—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –õ–æ–≥–∏–∫–∞ AI-–∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ routers/          # API –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils/           # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è RAG
‚îú‚îÄ‚îÄ auth/                 # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ services/         # JWT –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ routers/          # Login/Register
‚îÇ   ‚îî‚îÄ‚îÄ schemas/          # –°—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ core/                 # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database.py       # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ celery_app.py     # Celery –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/      # Middleware –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/       # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ tasks/                # Celery —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ document_tasks.py # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ wallet_tasks.py   # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ—à–µ–ª—å–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ telegram_tasks.py # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ aiogram_bot/          # Telegram –±–æ—Ç—ã
    ‚îî‚îÄ‚îÄ main.py           # –ú–µ–Ω–µ–¥–∂–µ—Ä –±–æ—Ç–æ–≤
```

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **JWT —Ç–æ–∫–µ–Ω—ã** —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- **bcrypt** —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (user, admin, superuser)
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** —Å middleware

### ü§ñ AI-–∞–≥–µ–Ω—Ç—ã –∏ RAG
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: PDF, DOCX, XLSX, TXT
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫** —Å ChromaDB
- **LangChain –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è RAG
- **Ollama** –ª–æ–∫–∞–ª—å–Ω—ã–µ LLM –º–æ–¥–µ–ª–∏
- **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### üí∞ –ë–ª–æ–∫—á–µ–π–Ω –∫–æ—à–µ–ª—å–∫–∏
- **ARBITRUM –∫–æ—à–µ–ª—å–∫–∏**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **Arbitrum –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **USDT –±–∞–ª–∞–Ω—Å—ã**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** seed-—Ñ—Ä–∞–∑ —Å AES-256

### üì± Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ—Ç—ã**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–∞—Ç–æ–≤**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- **Webhook –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã

### üí≥ –ü–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–ª–∞—Ç–µ–∂–∏
- **–ì–∏–±–∫–∏–µ –ø–ª–∞–Ω—ã**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ç–∞—Ä–∏—Ñ—ã
- **USDT –ø–ª–∞—Ç–µ–∂–∏**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TRC20
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–∏
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
- **Prometheus –º–µ—Ç—Ä–∏–∫–∏**: –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **Health checks**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
- **Performance tracking**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **FastAPI** - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Python web-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **PostgreSQL** - –û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis** - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥–∏
- **Celery** - –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- **SQLAlchemy** - ORM —Å async –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- **Alembic** - –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

### AI/ML –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **LangChain** - AI/ML –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **ChromaDB** - –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Ollama** - –õ–æ–∫–∞–ª—å–Ω—ã–µ LLM –º–æ–¥–µ–ª–∏
- **Sentence Transformers** - –≠–º–±–µ–¥–¥–∏–Ω–≥–∏
- **Hugging Face** - Pre-trained –º–æ–¥–µ–ª–∏

### –ë–ª–æ–∫—á–µ–π–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **Web3.py** - Ethereum –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **APTOS SDK** - APTOS –±–ª–æ–∫—á–µ–π–Ω
- **HD Wallet** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—à–µ–ª—å–∫–æ–≤
- **BIP39/BIP44** - –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ—à–µ–ª—å–∫–æ–≤
- **Cryptography** - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ DevOps
- **Prometheus Client** - –ú–µ—Ç—Ä–∏–∫–∏
- **Flower** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Celery
- **Docker** - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Uvicorn** - ASGI —Å–µ—Ä–≤–µ—Ä

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd backend
poetry install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example –≤ .env –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ
cp .env.example .env
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic revision --autogenerate -m "Initial migration"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
poetry run alembic upgrade head
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
poetry run uvicorn main:app --reload

# –ü—Ä–æ–¥–∞–∫—à–Ω
poetry run uvicorn main:app --host 0.0.0.0 --port 8000
```

### 5. –ó–∞–ø—É—Å–∫ Celery
```bash
# Worker
poetry run celery -A src.core.celery_app worker --loglevel=info

# Beat (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫)
poetry run celery -A src.core.celery_app beat --loglevel=info

# Flower (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
poetry run celery -A src.core.celery_app flower
```

---

## üì° API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/api/v1/auth/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| POST | `/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚ùå |
| POST | `/login` | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É | ‚ùå |
| GET | `/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ | ‚ùå |

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/api/v1/users/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| GET | `/me/profile` | –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å | ‚úÖ |
| PUT | `/me/profile` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è | ‚úÖ |
| GET | `/balance` | –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚úÖ |
| GET | `/admin/all` | –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∞–¥–º–∏–Ω) | ‚úÖ (admin) |

### ü§ñ AI-–∞–≥–µ–Ω—Ç—ã (`/api/v1/agents/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| GET | `/` | –°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤ | ‚úÖ |
| POST | `/` | –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ | ‚úÖ |
| GET | `/{agent_id}` | –î–µ—Ç–∞–ª–∏ –∞–≥–µ–Ω—Ç–∞ | ‚úÖ |
| PUT | `/{agent_id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ | ‚úÖ |
| DELETE | `/{agent_id}` | –£–¥–∞–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ | ‚úÖ |

### üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã (`/api/v1/documents/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| GET | `/` | –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ | ‚úÖ |
| POST | `/upload` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | ‚úÖ |
| GET | `/{document_id}` | –î–µ—Ç–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | ‚úÖ |
| POST | `/{document_id}/analyze` | –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | ‚úÖ |
| DELETE | `/{document_id}` | –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | ‚úÖ |

### üí∞ –ö–æ—à–µ–ª—å–∫–∏ (`/api/v1/wallets/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| GET | `/my` | –ú–æ–∏ –∫–æ—à–µ–ª—å–∫–∏ | ‚úÖ |
| POST | `/generate` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—à–µ–ª—å–∫–∞ | ‚úÖ |
| GET | `/my/{network}` | –ö–æ—à–µ–ª–µ–∫ –ø–æ —Å–µ—Ç–∏ | ‚úÖ |
| GET | `/my/{network}/balance` | –ë–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞ | ‚úÖ |

### üì± Telegram (`/api/v1/telegram/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|----------|----------|----------------|
| GET | `/configs` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç–æ–≤ | ‚úÖ |
| POST | `/configs` | –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | ‚úÖ |
| GET | `/monitoring` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–∞—Ç–æ–≤ | ‚úÖ |
| POST | `/monitoring` | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | ‚úÖ |

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASS=password
DB_NAME=mara_ai

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT
SECRET_KEY=your-super-secret-key-here
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Ollama
OLLAMA_HOST=localhost
OLLAMA_PORT=11434

# –ë–ª–æ–∫—á–µ–π–Ω
WALLET_ENCRYPTION_KEY=your-encryption-key-here

# Telegram
TELEGRAM_BOT_TOKEN=your-bot-token
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
poetry run pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
poetry run pytest --cov=src

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
poetry run pytest tests/test_auth.py

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
poetry run pytest tests/test_async.py
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤
```
tests/
‚îú‚îÄ‚îÄ conftest.py              # –§–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ constants.py             # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ fixtures/                # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îú‚îÄ‚îÄ agents.py
‚îÇ   ‚îî‚îÄ‚îÄ documents.py
‚îî‚îÄ‚îÄ api/                     # API —Ç–µ—Å—Ç—ã
    ‚îî‚îÄ‚îÄ account/
        ‚îú‚îÄ‚îÄ test_users.py
        ‚îî‚îÄ‚îÄ test_auth.py
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Prometheus –º–µ—Ç—Ä–∏–∫–∏
- **HTTP –∑–∞–ø—Ä–æ—Å—ã**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, –æ—à–∏–±–∫–∏
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **Celery –∑–∞–¥–∞—á–∏**: –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ, –Ω–µ—É–¥–∞—á–Ω—ã–µ, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ë–ª–æ–∫—á–µ–π–Ω**: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –±–∞–ª–∞–Ω—Å—ã, –æ—à–∏–±–∫–∏

### Health checks
- **Database**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- **Redis**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- **Ollama**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ LLM
- **Celery**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏** –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- **–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: DEBUG, INFO, WARNING, ERROR
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: User ID, Request ID, Agent ID
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ Loki

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **JWT —Ç–æ–∫–µ–Ω—ã** —Å HMAC-SHA256
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–æ–≤** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è
- **Refresh —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π —Å–µ—Å—Å–∏–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç CSRF** –∞—Ç–∞–∫

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: user, admin, superuser
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** –Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–Ω–∏—è** —Ä–µ—Å—É—Ä—Å–∞–º–∏
- **Rate limiting** –¥–ª—è API

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **–ü–∞—Ä–æ–ª–∏**: bcrypt —Å —Å–æ–ª—å—é
- **Seed —Ñ—Ä–∞–∑—ã**: AES-256-GCM
- **API –∫–ª—é—á–∏**: –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ SHA-256
- **–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç**: HTTPS/TLS 1.3

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- **Pydantic —Å—Ö–µ–º—ã** –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **SQL injection** –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ SQLAlchemy
- **XSS –∑–∞—â–∏—Ç–∞** —á–µ—Ä–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **CORS** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

---

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Async/await** –¥–ª—è –≤—Å–µ—Ö I/O –æ–ø–µ—Ä–∞—Ü–∏–π
- **Connection pooling** –¥–ª—è –ë–î
- **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Lazy loading** –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ Docker
- **Load balancing** –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- **Database sharding** –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **CDN** –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **APM** –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
- **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ú–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞** –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- **–ê–ª–µ—Ä—Ç—ã** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **OpenAPI —Å—Ö–µ–º–∞**: http://localhost:8000/openapi.json

### –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Docstrings** –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **Type hints** –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è** –≤ README

---

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### Code Style
- **Black** –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- **isort** –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤
- **flake8** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∏–ª—è
- **mypy** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤

### Git workflow
- **Feature branches** –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **Pull requests** –¥–ª—è code review
- **Automated tests** –≤ CI/CD
- **Semantic versioning** –¥–ª—è —Ä–µ–ª–∏–∑–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
1. –°–æ–∑–¥–∞–π—Ç–µ feature branch
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é
4. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
5. –°–æ–∑–¥–∞–π—Ç–µ pull request

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: [GitHub Issues](https://github.com/mp4treiser/mara-ai/issues)
- **Discussions**: [GitHub Discussions](https://github.com/mp4treiser/mara-ai/discussions)
- **Email**: mp4treiser@gmail.com